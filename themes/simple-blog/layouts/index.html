{{ define "main" }}
<div class="home-page">
  <!-- About section -->
  <section class="about-section">
    {{ if .Content }}
    <div class="about-content">
      {{ .Content }}
    </div>
    {{ end }}
  </section>

  <!-- Recent blog posts -->
  {{ $posts := where .Site.RegularPages "Section" "blog" }}
  {{ if $posts }}
  <section class="recent-posts">
    <h2>Recent Blog Posts</h2>
    <div class="posts-list">
      {{ range first 5 $posts }}
      <article class="post-preview">
        <h3 class="post-title">
          <a href="{{ .Permalink }}">{{ .Title }}</a>
        </h3>
        <div class="post-meta">
          <time datetime="{{ .Date.Format " 2006-01-02" }}">
            {{ .Date.Format "January 2, 2006" }}
          </time>
          {{ if .Params.tags }}
          <div class="post-tags">
            {{ range .Params.tags }}
            <span class="tag">{{ . }}</span>
            {{ end }}
          </div>
          {{ end }}
        </div>
        {{ if .Summary }}
        <div class="post-summary">
          {{ .Summary }}
        </div>
        {{ end }}
      </article>
      {{ end }}
    </div>

    {{ if gt (len $posts) 5 }}
    <div class="view-all">
      <a href="{{ " blog" | relURL }}" class="view-all-link">View all posts →</a>
    </div>
    {{ end }}
  </section>
  {{ end }}

  <!-- Publications section -->
  {{ if .Site.Params.showPublications }}
  {{ $publications := where .Site.RegularPages "Section" "publications" }}
  {{ if $publications }}
  <section class="publications-section">
    <h2>Recent Publications</h2>
    <div class="publications-list">
      {{ range first 3 $publications }}
      <article class="publication-preview">
        <h3 class="publication-title">
          <a href="{{ .Permalink }}">{{ .Title }}</a>
        </h3>
        <div class="publication-meta">
          {{ if .Params.date }}
          <time datetime="{{ .Date.Format " 2006-01-02" }}">
            {{ .Date.Format "2006" }}
          </time>
          {{ end }}
          {{ if .Params.journal }}
          <span class="journal">{{ .Params.journal }}</span>
          {{ end }}
        </div>
        {{ if .Summary }}
        <div class="publication-summary">
          {{ .Summary }}
        </div>
        {{ end }}
      </article>
      {{ end }}
    </div>

    {{ if gt (len $publications) 3 }}
    <div class="view-all">
      <a href="{{ " publications" | relURL }}" class="view-all-link">View all publications →</a>
    </div>
    {{ end }}
  </section>
  {{ end }}
  {{ end }}
</div>
{{ end }}